@inherits Custom.Hybrid.Razor14
@using System.Text.RegularExpressions;
@using ToSic.Razor.Blade;
@{
  var helpers = CreateInstance("Helpers.cs");
  // Get parameters
  // var filePath = DynamicModel.Path;
  var result = DynamicModel.Result;
  var language = DynamicModel.Language ?? "html";

  // Prepare variables which are initialized in try/catch
  int size = Kit.Convert.ToInt(DynamicModel.Size, fallback: 600);
  var domAttribute = "result-" + CmsContext.Module.Id;

  // Low risk stuff outside of try/catch
  var rndId = Guid.NewGuid().ToString();

  var options = new {
    sourceCodeId = "result" + rndId,
    language = "",
  };

  if (Settings.CodeEditor == "Ace")
  {
    options.language = "ace/mode/" + language;
  } else if (Settings.CodeEditor == "Monaco") {
    options.language = language;
  }
  
}

@if (Settings.CodeEditor == "Ace")
{
  <script src="//cdn.jsdelivr.net/ace/1.2.6/noconflict/ace.js" type="text/javascript" charset="utf-8"></script>
  <script src="//cdn.jsdelivr.net/ace/1.2.6/noconflict/ext-language_tools.js" async="false"></script>
} else if (Settings.CodeEditor == "Monaco") {
  <script src="https://cdnjs.cloudflare.com/ajax/libs/monaco-editor/0.33.0/min/vs/loader.min.js" integrity="sha512-O9SYDgWAM3bEzit1z6mkFd+dxKUplO/oB8UwYGAkg2Zy/WzDUQ2mYA/ysk3c0CxiXAN4u8T9JeZ0Ahk2Jj/33Q==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
}


<style>
  .pre-result {
    background-color: aliceblue;
  }
</style>

<pre class="pre-result" id='@("result" + rndId)' style="height: @(size + "px"); font-size: 16px">@result</pre>

@Html.Partial("_source-code.PartAssets.cshtml", new { DomAttribute = domAttribute, Options = options })