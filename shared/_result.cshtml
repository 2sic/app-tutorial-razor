@inherits Custom.Hybrid.Razor14
@using System.Text.RegularExpressions;
@using ToSic.Razor.Blade;
@{
  var helpers = CreateInstance("Helpers.cs");
  var sourceCode = CreateInstance("SourceCode.cs");

  // Get parameters
  var result = DynamicModel.Result;
  var language = DynamicModel.Language ?? "html";

  // Prepare variables which are initialized in try/catch
  var domAttribute = "result-" + CmsContext.Module.Id;

  result = sourceCode.SourceTrim(result);
  var size = sourceCode.Size(DynamicModel.Size, result);

  // Low risk stuff outside of try/catch
  var rndId = Guid.NewGuid().ToString();

  var aceOptions = new {
    sourceCodeId = "result" + rndId,
    language = "ace/mode/" + language,
  };
}

<script src="//cdn.jsdelivr.net/ace/1.2.6/noconflict/ace.js" type="text/javascript" charset="utf-8"></script>
<script src="//cdn.jsdelivr.net/ace/1.2.6/noconflict/ext-language_tools.js" async="false"></script>

<style>
  .pre-result {
    background-color: aliceblue;
  }
</style>

<pre class="pre-result" id='@("result" + rndId)' style="height: @(size + "px"); font-size: 16px">@result</pre>

@Html.Partial("_source-code.PartAssets.cshtml", new { DomAttribute = domAttribute, AceOptions = aceOptions })